!function(){"use strict";let e={v:!1};function t(e){const t=document.querySelector("#text");console.log(e),t.innerText+=e+"\n",t.scrollTo({top:t.scrollHeight,behavior:"smooth"})}function o(e){if(0==e)return"0 Byte";var t=Math.trunc(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t))+" "+["Bytes","KB","MB","GB","TB"][t]}window.s=e;var n=function(e){var t=/(%?)(%([jds]))/g,o=Array.prototype.slice.call(arguments,1);return o.length&&(e=e.replace(t,(function(e,t,n,i){var r=o.shift();switch(i){case"s":r=""+r;break;case"d":r=Number(r);break;case"j":r=JSON.stringify(r)}return t?(o.unshift(r),e):r}))),o.length&&(e+=" "+o.join(" ")),""+(e=e.replace(/%{2,2}/g,"%"))};const i="מוריד את קובץ %s...",r="מוריד את תמונת האלבום...",s="אירעה שגיאה בעת הורדת קובץ %s",c="דוחס את קובץ %s...",a="מכין קובץ להורדה...",l="הקובץ מוכן להורדה!",d="מקובץ %s ירדו %s מתוך %s",u="אתר זה, איננו jewishmusic.fm!",w="בדף זה, אין קבצי אודיו!";function m(i,r=0){let s;return new Promise((async(r,c)=>{s=fetch(i.url,{headers:{Range:"bytes=0-"}});const a=await s;(a.status<200||a.status>=400)&&r(null);const l=a.body.getReader(),u=a.headers.get("Content-Length");let w=0;const m=new Response(new ReadableStream({async start(r){const s=setInterval((()=>{t(n(d,i.file_name,o(w),o(u)))}),1e3);for(;;){if(e.v)throw clearInterval(s),r.close(),new Error("window closed!");const{done:t,value:o}=await l.read();if(t){clearInterval(s);break}w+=o.length,r.enqueue(o)}r.close()}}));r(await m.blob())}))}async function h(){const o=document.querySelector("progress"),d=function(){const e=document.querySelectorAll("audio > source");let t=Array.from(e);const o=Array();return t.forEach((e=>{o.push({url:e.src.replace("http://","https://"),file_name:e.parentElement.parentElement.querySelector("h3").innerText})})),o}();let u=new window.JSZip;o.max=d.length;let w=0;for(const r of d){if(e.v)throw new Error("window closed!");t(n(i,r.file_name));const a=await m(r);if(null!==a){t(n(c,r.file_name));const e=r.url.split(".").pop();u.file(r.file_name+"."+e,a,{binary:!0}),w++,o.value=w}else t(n(s,r.file_name))}t(n(r)),fetch(document.querySelector(".webpexpress-processed").src).then((e=>e.blob())).then((e=>{u.file("AlbumArtSmall",e,{binary:!0}),u.file("Folder",e,{binary:!0})})),t(n(a)),await async function(t){const o=document.querySelector(".album-title").innerText,n=document.querySelector(".arts_name").innerText,i=`${o} - ${n}`,r=await t.generateAsync({type:"blob"});if(e.v)throw new Error("window closed!");!async function(e,t){var o=URL.createObjectURL(e),n=document.createElement("a");n.href=o,n.download=t||"download",document.body.appendChild(n),n.click(),n.remove()}(r,i)}(u),t(n(l))}function p(){const t=document.querySelector(".download_from_jewish_music");e.v=!0,t.style.opacity="0",t.style.visibility="hidden",console.log("close window..."),setTimeout((()=>{t.remove()}),3e3)}(window.download_from_jewish_music=async function(){const e=document.querySelector(".download_from_jewish_music");try{console.log("Musicode7"),console.log("https://github.com/MusiCode1/jewish-music.fm"),function(){const e=document.querySelectorAll("audio > source");if("jewishmusic.fm"!==window.location.hostname)throw new Error(u);if(e.length<1)throw new Error(w)}(),e||await async function(){console.log("1");const e=document.createElement("style");e.innerHTML="#window{position:fixed;left:10%;right:10%;top:20%;bottom:20%;max-width:660px;margin:auto;backdrop-filter:blur(8px);border-radius:30px;background:rgba(255, 255, 255, 0.73);box-shadow:0px 0px 13px 1px;transition:all 3s ease-out;z-index:20;}#bar {position:absolute;height:50px;left:0;right:0;background:#7c7c7c;border-radius:30px 30px 0px 0px;}#window-text {height:100%;display:flex;align-items:center;justify-content:space-around;text-align:center;font-size:24px;line-height:28px;color:#ececec;font-family:system-ui;position:relative;width:calc(100% - 60px);}#close {position:absolute;width:20px;height:20px;left:40px;top:15px;background:#de4f4f;border-radius:50%;}#close:hover {background:#f87878;}#window-content {position:relative;top:50px;padding:2em;height:calc(100% - 50px);box-sizing:border-box;}progress {width:100%;height:50px;}#text {font-size:20px;font-family:system-ui;overflow-y:scroll;height:calc(100% - 50px);direction:rtl;}#credit {text-align:left;color:#b6abab;}";const t=document.createElement("div");t.innerHTML='<div id="window" style="visibility:visible; opacity: 1;"><div id="bar"><div id="window-text">הורדה מאתר Jewish-music.Fm</div><div id="close" on:click="window.close()" ></div></div><div id="window-content"><progress value="0" max="1"></progress><div id="text"></div><div id="credit"><a href="https://github.com/MusiCode1/jewish-music.fm" target="_"><em>MusiCode</em></a></div></div></div>',t.classList.add("download_from_jewish_music"),document.body.appendChild(e),document.body.appendChild(t),await new Promise((e=>setTimeout(e,0))),document.querySelector("#close").onclick=p}(),await async function(e){const t=document.createElement("script");t.type="text/javascript",t.src=e,document.head.appendChild(t),await new Promise((e=>t.onload=e))}("https://cdnjs.cloudflare.com/ajax/libs/jszip/3.6.0/jszip.min.js"),await h().finally((()=>{p()}))}catch(e){throw"window closed!"===e.massage?(console.log(e.massage),e):(alert(e),p(),e)}})()}();
